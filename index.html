
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>战国·与伍同行</title>
    <link href="/fonts/NotoSerifSC.css" rel="stylesheet">
    <style>
        html, body {
            font-family: 'Noto Serif SC', serif;
            background-color: #000;
            color: #e2e8f0;
            margin: 0;
            overflow: hidden;
            width: 100%;
            height: 100%;
        }
        #root {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
            overflow: hidden;
        }
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b;
        }
        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 3px;
        }

        /* ==================== 战斗特效动画 ==================== */

        /* 伤害数字上飘渐隐 */
        @keyframes floatUp {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            20% { opacity: 1; transform: translateY(-8px) scale(1.15); }
            100% { opacity: 0; transform: translateY(-50px) scale(0.8); }
        }
        .anim-float-up {
            animation: floatUp 1.2s ease-out forwards;
        }

        /* 暴击数字 - 更大更震撼 */
        @keyframes floatUpCrit {
            0% { opacity: 1; transform: translateY(0) scale(0.5); }
            15% { opacity: 1; transform: translateY(-5px) scale(1.5); }
            30% { opacity: 1; transform: translateY(-12px) scale(1.2); }
            100% { opacity: 0; transform: translateY(-60px) scale(0.7); }
        }
        .anim-float-up-crit {
            animation: floatUpCrit 1.5s ease-out forwards;
        }

        /* 未命中文字 */
        @keyframes floatMiss {
            0% { opacity: 0.9; transform: translateY(0) translateX(0); }
            100% { opacity: 0; transform: translateY(-30px) translateX(10px); }
        }
        .anim-float-miss {
            animation: floatMiss 1s ease-out forwards;
        }

        /* 受击单位抖动 */
        @keyframes hitShake {
            0%, 100% { transform: translateX(0); }
            10% { transform: translateX(-4px) rotate(-1deg); }
            20% { transform: translateX(4px) rotate(1deg); }
            30% { transform: translateX(-3px); }
            40% { transform: translateX(3px); }
            50% { transform: translateX(-2px); }
            60% { transform: translateX(2px); }
            70% { transform: translateX(-1px); }
            80% { transform: translateX(1px); }
        }
        .anim-hit-shake {
            animation: hitShake 0.4s ease-out;
        }

        /* 未命中目标闪避动作 */
        @keyframes dodgeLeft {
            0% { transform: translateX(0) rotate(0deg); }
            20% { transform: translateX(-14px) rotate(-4deg); }
            55% { transform: translateX(-6px) rotate(-1deg); }
            100% { transform: translateX(0) rotate(0deg); }
        }
        .anim-dodge-left {
            animation: dodgeLeft 0.32s cubic-bezier(0.25, 0.9, 0.35, 1);
        }

        @keyframes dodgeRight {
            0% { transform: translateX(0) rotate(0deg); }
            20% { transform: translateX(14px) rotate(4deg); }
            55% { transform: translateX(6px) rotate(1deg); }
            100% { transform: translateX(0) rotate(0deg); }
        }
        .anim-dodge-right {
            animation: dodgeRight 0.32s cubic-bezier(0.25, 0.9, 0.35, 1);
        }

        /* 受击红色闪光叠加 */
        @keyframes hitFlash {
            0% { opacity: 0.7; }
            100% { opacity: 0; }
        }
        .anim-hit-flash {
            animation: hitFlash 0.4s ease-out forwards;
        }

        /* 屏幕震动 - 轻微 */
        @keyframes screenShakeLight {
            0%, 100% { transform: translate(0, 0); }
            10% { transform: translate(-2px, 1px); }
            20% { transform: translate(2px, -1px); }
            30% { transform: translate(-1px, 2px); }
            40% { transform: translate(1px, -1px); }
            50% { transform: translate(-1px, 1px); }
        }
        .anim-screen-shake-light {
            animation: screenShakeLight 0.3s ease-out;
        }

        /* 屏幕震动 - 强烈 */
        @keyframes screenShakeHeavy {
            0%, 100% { transform: translate(0, 0); }
            10% { transform: translate(-5px, 3px); }
            20% { transform: translate(5px, -3px); }
            30% { transform: translate(-4px, 4px); }
            40% { transform: translate(3px, -2px); }
            50% { transform: translate(-3px, 2px); }
            60% { transform: translate(2px, -2px); }
            70% { transform: translate(-1px, 1px); }
        }
        .anim-screen-shake-heavy {
            animation: screenShakeHeavy 0.5s ease-out;
        }

        /* 日志条目滑入 */
        @keyframes slideInLeft {
            0% { opacity: 0; transform: translateX(-20px); }
            100% { opacity: 1; transform: translateX(0); }
        }
        .anim-slide-in {
            animation: slideInLeft 0.3s ease-out;
        }

        /* 中央横幅弹入淡出 */
        @keyframes bannerInOut {
            0% { opacity: 0; transform: translateX(-50%) translateY(10px) scale(0.9); }
            10% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1.05); }
            20% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }
            80% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-10px) scale(0.95); }
        }
        .anim-banner {
            animation: bannerInOut 2s ease-in-out forwards;
        }

        /* 击杀爆发效果 */
        @keyframes deathBurst {
            0% { opacity: 0.8; transform: scale(0.3); }
            40% { opacity: 0.6; transform: scale(1.2); }
            100% { opacity: 0; transform: scale(2); }
        }
        .anim-death-burst {
            animation: deathBurst 0.8s ease-out forwards;
        }

        /* 传世品质脉动光效 */
        @keyframes legendaryPulse {
            0%, 100% { box-shadow: 0 0 8px rgba(251,191,36,0.3), inset 0 0 8px rgba(251,191,36,0.05); }
            50% { box-shadow: 0 0 20px rgba(251,191,36,0.6), inset 0 0 15px rgba(251,191,36,0.1); }
        }
        .anim-legendary-pulse {
            animation: legendaryPulse 2s ease-in-out infinite;
        }

        /* 珍品品质微光 */
        @keyframes epicGlow {
            0%, 100% { box-shadow: 0 0 6px rgba(168,85,247,0.25); }
            50% { box-shadow: 0 0 14px rgba(168,85,247,0.45); }
        }
        .anim-epic-glow {
            animation: epicGlow 2.5s ease-in-out infinite;
        }

        /* 传世红装品质 - 红色脉动光晕 */
        @keyframes uniqueGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(239,68,68,0.4), inset 0 0 8px rgba(239,68,68,0.08); }
            50% { box-shadow: 0 0 25px rgba(239,68,68,0.7), inset 0 0 18px rgba(239,68,68,0.15); }
        }
        .anim-unique-glow {
            animation: uniqueGlow 1.8s ease-in-out infinite;
        }

        #boot-loading {
            position: fixed;
            inset: 0;
            z-index: 2147483646;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #cbd5e1;
            background: #000;
            letter-spacing: 1px;
        }

        #boot-error {
            position: fixed;
            left: 12px;
            right: 12px;
            top: 12px;
            z-index: 2147483647;
            display: none;
            padding: 12px;
            max-height: 45vh;
            overflow: auto;
            border: 1px solid rgba(239, 68, 68, 0.5);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.9);
            color: #fecaca;
            font-size: 12px;
            line-height: 1.45;
            white-space: pre-wrap;
            word-break: break-word;
        }

    </style>
</head>
<body>
    <div id="boot-loading">正在加载游戏...</div>
    <div id="boot-error"></div>
    <div id="root"></div>
    <script>
        (function () {
            var ready = false;
            var loadingEl = null;
            var errorEl = null;
            var bootTimeoutMs = 10000;

            function getLoadingEl() {
                if (!loadingEl) loadingEl = document.getElementById('boot-loading');
                return loadingEl;
            }

            function getErrorEl() {
                if (!errorEl) errorEl = document.getElementById('boot-error');
                return errorEl;
            }

            function hideLoading() {
                var el = getLoadingEl();
                if (el) el.style.display = 'none';
            }

            function showBootError(title, detail) {
                var el = getErrorEl();
                if (!el) return;
                var text = '[启动异常] ' + title;
                if (detail) text += '\n\n' + detail;
                el.textContent = text;
                el.style.display = 'block';
            }

            function markReady() {
                if (ready) return;
                ready = true;
                hideLoading();
            }

            window.addEventListener('error', function (event) {
                var target = event && event.target;
                if (target && target.tagName === 'SCRIPT') {
                    showBootError('脚本资源加载失败', target.src || '(未知脚本)');
                    return;
                }

                var message = event && event.message ? event.message : '未知错误';
                var stack = event && event.error && event.error.stack ? String(event.error.stack) : '';
                showBootError(message, stack);
            }, true);

            window.addEventListener('unhandledrejection', function (event) {
                var reason = event && event.reason;
                var text = '';
                if (typeof reason === 'string') text = reason;
                else if (reason && reason.stack) text = String(reason.stack);
                else text = JSON.stringify(reason);
                showBootError('Promise 未捕获异常', text);
            });

            document.addEventListener('DOMContentLoaded', function () {
                var root = document.getElementById('root');
                if (!root) return;

                if (root.childNodes.length > 0) {
                    markReady();
                    return;
                }

                var observer = new MutationObserver(function () {
                    if (root.childNodes.length > 0) {
                        observer.disconnect();
                        markReady();
                    }
                });
                observer.observe(root, { childList: true, subtree: true });
            });

            setTimeout(function () {
                if (!ready) {
                    showBootError('启动超时', '页面超过 10 秒仍未完成渲染，可能是 WebView 兼容或运行时异常。');
                }
            }, bootTimeoutMs);
        })();
    </script>
    <script type="module" src="/index.tsx"></script>
</body>
</html>
